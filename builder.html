<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Resume Upload Form</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
</head>
<body class="bg-gray-50 flex items-center justify-center min-h-screen p-6">
  <div class="max-w-md w-full bg-white p-8 rounded-xl shadow-lg">
    <h1 class="text-3xl font-bold mb-6 text-center">Upload Your Resume</h1>

    <form id="uploadForm" class="flex flex-col items-center border-4 border-dashed border-blue-400 rounded-lg py-16 cursor-pointer hover:bg-blue-50 transition">
      <label for="fileUpload" class="flex flex-col items-center cursor-pointer">
        <svg class="w-16 h-16 text-blue-500 mb-4" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" aria-hidden="true">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v2a2 2 0 002 2h12a2 2 0 002-2v-2M12 12v6m0 0v-6m-3 3h6"/>
        </svg>
        <span class="text-blue-700 font-semibold text-lg mb-2">Drag & Drop or Click to Upload</span>
        <span class="text-gray-500 text-sm">Supported formats: PDF, DOC, DOCX</span>
      </label>
      <input id="fileUpload" type="file" name="resume" class="hidden" accept=".pdf,.doc,.docx" />
    </form>

    <div id="fileInfo" class="mt-4 text-center text-gray-700"></div>

    <button type="button" id="submitBtn" class="mt-8 bg-blue-600 hover:bg-blue-700 text-white py-3 px-8 rounded-lg font-semibold w-full disabled:opacity-50" disabled>
      Upload Resume
    </button>

    <div id="result" class="mt-6 text-gray-800 whitespace-pre-wrap"></div>
  </div>

  <script>
    const fileInput = document.getElementById('fileUpload');
    const fileInfo = document.getElementById('fileInfo');
    const submitBtn = document.getElementById('submitBtn');
    const resultDiv = document.getElementById('result');

    fileInput.addEventListener('change', () => {
      if (fileInput.files.length > 0) {
        fileInfo.textContent = `Selected file: ${fileInput.files[0].name}`;
        submitBtn.disabled = false;
      } else {
        fileInfo.textContent = '';
        submitBtn.disabled = true;
      }
    });

    document.getElementById('uploadForm').addEventListener('click', () => {
      fileInput.click();
    });

    submitBtn.addEventListener('click', async () => {
      if (fileInput.files.length === 0) {
        alert("Please select a file first.");
        return;
      }

      const formData = new FormData();
      formData.append("resume", fileInput.files[0]);

      submitBtn.disabled = true;
      submitBtn.textContent = "Analyzing... ‚è≥";
      resultDiv.textContent = "";

      try {
        const response = await fetch("http://localhost:5000/api/resume/analyze", {
          method: "POST",
          body: formData
        });

        if (!response.ok) {
          throw new Error("Upload failed");
        }

        const data = await response.json();
        resultDiv.textContent = data.analysis || "No analysis returned.";
      } catch (err) {
        console.error(err);
        alert("Error uploading resume: " + err.message);
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = "Upload Resume";
      }
    });
  </script>
</body>
</html>
